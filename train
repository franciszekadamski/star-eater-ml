#!/usr/bin/python3

import json
from sklearn.ensemble import RandomForestClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.svm import SVC

from scripts.machine_learning import MLClassifier


def main():
    actor = MLClassifier(
        mapping_path='./mapping.json',
        mode="ALL",
        drop_empty_keys=True
    )
    actor.load('./models/model.pkl')
    actor.samples_to_database()
    actor.read_dataset()
    actor.train_test_split()
    actor.fit()
    accuracy = actor.evaluate()
    print(accuracy)
    actor.save("./models/model.pkl")


if __name__ == "__main__":
    main()
